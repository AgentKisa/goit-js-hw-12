{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst pixabayKey = '44070637-4c17cd33bb35071a705149900';\n\n// export function sendRequest(query, handleResponse) {\n//   const searchParams = new URLSearchParams({\n//     key: pixabayKey,\n//     q: query,\n//     image_type: 'photo',\n//     orientation: 'horizontal',\n//     safesearch: true,\n//   });\n\n//   return fetch(`https://pixabay.com/api/?${searchParams}`)\n//     .then(response => {\n//       if (!response.ok) {\n//         throw new Error(response.status);\n//       }\n//       return response.json();\n//     })\n//     .then(handleResponse)\n//     .catch(error => console.log(error));\n// }\n\nexport async function sendRequest(query, page = 1, perPage = 15) {\n  const { data } = await axios.get(`https://pixabay.com/api/?`, {\n    params: {\n      key: pixabayKey,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: perPage,\n      page: page,\n    },\n  });\n\n  return data;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function getLoaderHtml() {\n  return '<div class=\"loader\"></div>';\n}\n\nexport function showInputNotFound() {\n  iziToast.warning({\n    title: 'Fill in the search field',\n    position: 'topRight',\n  });\n}\n\nexport function showAlertNotFound() {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n  });\n}\n\nexport function getImageHtml(image) {\n  return `\n    <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"foto\" height=\"148\" width=\"360\">\n      <div class=\"info\" >\n        <p class=\"icon\">Likes: ${image.likes} </p>\n        <p class=\"icon\">Views: ${image.views}</p>\n        <p class=\"icon\">Comments: ${image.comments}</p>\n        <p class=\"icon\">Downloads: ${image.downloads}</p>\n      </div>\n    </a>`;\n}\n\nexport function getImagesHtml(images) {\n  return images.map(image => getImageHtml(image)).join('');\n}\nexport function showEndOfResults() {\n  const endMessage = document.createElement('p');\n  endMessage.textContent =\n    \"We're sorry, but you've reached the end of search results.\";\n  endMessage.style.textAlign = 'center';\n  endMessage.style.marginTop = '20px';\n  endMessage.classList.add('end-of-results-message');\n  document.body.appendChild(endMessage);\n}\n","import * as api from './js/pixabay-api';\nimport * as render from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loadMore = document.querySelector('.div-load');\n\nlet page = 1;\nconst perPage = 15;\nlet totalPages = 0;\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  const query = e.target.elements.searchInput.value.trim();\n\n  if (query === '') {\n    render.showInputNotFound();\n    return;\n  }\n\n  removeEndOfResultsMessage();\n\n  gallery.innerHTML = render.getLoaderHtml();\n\n  page = 1; // Сброс страницы при новом поиске\n\n  //   api.sendRequest(query, handleResponse);\n\n  loadMore.classList.add('load-more-hidden');\n\n  try {\n    const response = await api.sendRequest(query, page, perPage);\n    totalPages = Math.ceil(response.totalHits / perPage);\n    handleResponse(response);\n  } catch (error) {\n    console.error('error:', error);\n    render.showAlertNotFound();\n  }\n});\n\nfunction handleResponse(response, loadMoreBtn = false) {\n  if (!response || response.total === 0) {\n    render.showAlertNotFound();\n    gallery.innerHTML = '';\n    loadMore.classList.add('load-more-hidden');\n    return;\n  }\n  const images = response.hits;\n  console.log('response', response);\n  const galleryFilling = render.getImagesHtml(images);\n\n  //   gallery.innerHTML = galleryFilling;\n\n  if (loadMoreBtn) {\n    gallery.innerHTML += galleryFilling;\n  } else {\n    gallery.innerHTML = galleryFilling;\n  }\n\n  if (gallery.children.length < response.totalHits) {\n    loadMore.classList.remove('load-more-hidden');\n  } else {\n    loadMore.classList.add('load-more-hidden');\n    render.showEndOfResults();\n  }\n\n  render.lightbox.refresh();\n}\n\nloadMore.addEventListener('click', onLoadMore);\n\nasync function onLoadMore() {\n  page += 1;\n  const query = form.elements.searchInput.value.trim();\n\n  toggleLoadMoreAndLoader();\n\n  try {\n    const response = await api.sendRequest(query, page, perPage);\n    handleResponse(response, true);\n    smoothScroll();\n  } catch (error) {\n    console.error('error:', error);\n  } finally {\n    toggleLoadMoreAndLoader();\n  }\n}\n\nfunction toggleLoadMoreAndLoader() {\n  loadMore.classList.toggle('hidden');\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction removeEndOfResultsMessage() {\n  const endMessage = document.querySelector('.end-of-results-message');\n  if (endMessage) {\n    endMessage.remove();\n  }\n}\n"],"names":["pixabayKey","sendRequest","query","page","perPage","data","axios","lightbox","SimpleLightbox","getLoaderHtml","showInputNotFound","iziToast","showAlertNotFound","getImageHtml","image","getImagesHtml","images","showEndOfResults","endMessage","form","gallery","loadMore","totalPages","render.showInputNotFound","removeEndOfResultsMessage","render.getLoaderHtml","response","api.sendRequest","handleResponse","error","render.showAlertNotFound","loadMoreBtn","galleryFilling","render.getImagesHtml","render.showEndOfResults","render.lightbox","onLoadMore","toggleLoadMoreAndLoader","smoothScroll","cardHeight"],"mappings":"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"}